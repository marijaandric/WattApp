<div [ngClass]="{'light-mode':lightMode}"><p-selectButton class="flexRow width__fit-content margin-left__auto margin-bottom__16px" [options]="switchOptions" [(ngModel)]="switchValue" optionLabel="label" optionValue="value" (onChange)="updateView()"></p-selectButton>
</div>
<div *ngIf="switchValue == true">
  <div *ngFor="let devices of devicesByRoomType | keyvalue; index as i">
    
      <div class="hederContainer">
        <p class="roomNameHeader">{{ devices.key }}</p>
        <div class="arrow"><i class="fa-solid fa-angle-down"  [ngClass]="{'arrow-down': carousel[i],'arrow-right': !carousel[i]}"  (click)="collapseDevices(i)"></i></div>
        <p  class="roomSizeHeader">Total: {{ devices.value.length }}</p>
      </div>
    <p-carousel [value]="devices.value" [numVisible]="5" [circular]="false" [numScroll]="1" [responsiveOptions]="responsiveOptions" [ngClass]="{'hidden': carousel[i]}">
     <ng-template let-device pTemplate="device" >
          <app-device-card [device]="device" ></app-device-card>
      </ng-template>
    </p-carousel>
  </div>
</div>

<div *ngIf="switchValue == false">
  <p-table #dtAllDevices class="ui-table-default" [value]="devices" dataKey="id" [scrollable]="true" 
    [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]"
    [globalFilterFields]="['userId','deviceName','room', 'deviceType']" [paginator]="true"
    style="
    margin-top:calc(2.8%);
    display: flex;
    position: relative;
    flex-direction: column;
    height: fit-content;
    border-radius: 20px;
    background-color: #1b1b1b;
    box-shadow: 5px 5px 15px black;
    transition: ease-in-out;
    padding:10px 20px;
      ">

    <ng-template pTemplate="caption">
      <div class="flexRow">
          <h3>Devices</h3>
          <span class="p-input-icon-left margin-left__auto margin-right__16px">
              <i class="pi pi-search"></i>
              <input pInputText type="text" (input)="dtAllDevices.filterGlobal($any($event.target).value, 'contains')" placeholder="Search keyword" />
          </span>
          <button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dtAllDevices)"></button>
      </div>
    </ng-template>

    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="deviceName" style="min-width:15rem;   border-top:2px solid #46c5f1; border-bottom:2px solid #46c5f1;">
          <div class="flexRow">
              <p>Device name</p>
              <p-sortIcon field="deviceName"></p-sortIcon>
              <p-columnFilter class="ml-auto" type="text" field="deviceName" display="menu"></p-columnFilter>
          </div>
        </th>
        <th pSortableColumn="room" style="min-width:15rem;  border-top:2px solid #46c5f1; border-bottom:2px solid #46c5f1;">
          <div class="flexRow">
              <p>Room</p>
              <p-sortIcon field="room"></p-sortIcon>
              <p-columnFilter class="ml-auto" type="text" field="room" display="menu"></p-columnFilter>
          </div>
        </th>
        <th pSortableColumn="deviceType" style="min-width:10rem; border-top:2px solid #46c5f1; border-bottom:2px solid #46c5f1;">
          <div class="flexRow">
              <p>Type</p>
              <p-sortIcon field="deviceType"></p-sortIcon>
              <p-columnFilter class="ml-auto" type="text" field="deviceType" display="menu"></p-columnFilter>
          </div>
        </th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-device>
      <tr>
        <td><a [routerLink]="['/device', device.id]">{{ device.deviceName }}</a></td>
        <td><a [routerLink]="['/device', device.id]">{{device.room}}</a></td>
        <td><a [routerLink]="['/device', device.id]">{{device.deviceType}}</a></td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
          <td colspan="3">No devices found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
